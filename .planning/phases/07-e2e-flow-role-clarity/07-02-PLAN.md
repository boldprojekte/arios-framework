---
phase: 07-e2e-flow-role-clarity
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/arios-cli/templates/.claude/commands/arios/orchestrate.md
  - packages/arios-cli/templates/.claude/agents/researcher.md
  - packages/arios-cli/templates/.claude/agents/planner.md
  - packages/arios-cli/templates/.claude/agents/executor.md
autonomous: true

must_haves:
  truths:
    - "Orchestrator announces when spawning each agent with name and purpose"
    - "Orchestrator summarizes subagent findings in compact format after completion"
    - "Subagent return messages are structured and concise (5-10 lines)"
    - "User sees orchestrator summaries, not raw subagent output"
  artifacts:
    - path: "packages/arios-cli/templates/.claude/commands/arios/orchestrate.md"
      provides: "Agent spawn announcements and result summaries"
      contains: "Spawning"
    - path: "packages/arios-cli/templates/.claude/agents/researcher.md"
      provides: "Compact return message format"
      contains: "RESEARCH COMPLETE"
    - path: "packages/arios-cli/templates/.claude/agents/planner.md"
      provides: "Compact return message format"
      contains: "PLANNING COMPLETE"
    - path: "packages/arios-cli/templates/.claude/agents/executor.md"
      provides: "Compact return message format"
      contains: "EXECUTION COMPLETE"
  key_links:
    - from: "orchestrate.md"
      to: "researcher.md"
      via: "Task tool spawn with announcement"
      pattern: "Spawning researcher"
    - from: "orchestrate.md"
      to: "planner.md"
      via: "Task tool spawn with announcement"
      pattern: "Spawning planner"
---

<objective>
Implement orchestrator role visibility with spawn announcements and result summaries.

Purpose: Users understand what the AI is doing at all times - when it delegates vs when it acts directly. Subagent details stay internal while orchestrator provides human-digestible summaries.

Output: Updated orchestrate.md with announcement/summary patterns, updated agent files with compact return formats.
</objective>

<execution_context>
@/Users/j.franke/.claude/get-shit-done/workflows/execute-plan.md
@/Users/j.franke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-e2e-flow-role-clarity/07-CONTEXT.md
@.planning/phases/07-e2e-flow-role-clarity/07-RESEARCH.md
@packages/arios-cli/templates/.claude/commands/arios/orchestrate.md
@packages/arios-cli/templates/.claude/agents/researcher.md
@packages/arios-cli/templates/.claude/agents/planner.md
@packages/arios-cli/templates/.claude/agents/executor.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add spawn announcements to orchestrator</name>
  <files>packages/arios-cli/templates/.claude/commands/arios/orchestrate.md</files>
  <action>
Update /arios:orchestrate to announce all agent spawns:

1. Add "Role Visibility" section after Instructions:
```
## Role Visibility

**Always announce before spawning:**

Before each Task tool call, display:
```
## Delegating to {Agent Name}

**Purpose:** {one-line description of what agent will do}
**Scope:** {what files/topics agent will investigate}
**Output:** `{output file path}`

Spawning {agent} agent...
```

**After agent returns, summarize:**
```
## {Stage} Complete

**Status:** {Success/Partial/Failed}
**Findings:** {brief 1-line count: "3 patterns identified, 2 gaps found"}
**Confidence:** {HIGH/MEDIUM/LOW}

Key insights:
- {insight 1}
- {insight 2}
- {insight 3}

Full details: `{output file path}`
```

**Never show raw subagent output.** User sees orchestrator summary. Details available via Ctrl+O if curious.
```

2. Update Spawn Patterns section to include announcement in each pattern:

For Researcher:
```
## Spawning Researcher

Display announcement:
"## Delegating to Researcher

**Purpose:** Investigate {topic}
**Scope:** {investigation areas}
**Output:** `.planning/phases/{phase}/{phase}-RESEARCH.md`

Spawning researcher agent..."

Then use Task tool to spawn .claude/agents/researcher.md
```

For Planner:
```
## Spawning Planner

Display announcement:
"## Delegating to Planner

**Purpose:** Create execution plan from ideation findings
**Scope:** Phase {N} tasks breakdown
**Output:** `.planning/phases/{phase}/{phase}-*-PLAN.md`

Spawning planner agent..."

Then use Task tool to spawn .claude/agents/planner.md
```

For Executor:
```
## Spawning Executor

Display announcement:
"## Delegating to Executor

**Purpose:** Execute Wave {N} tasks
**Scope:** {plan IDs in wave}
**Output:** Task completion, code changes

Spawning executor agent..."

Then use Task tool to spawn .claude/agents/executor.md
```

3. Add summary display after each subagent returns, reading from the handoff file and presenting in compact format
  </action>
  <verify>Read orchestrate.md and confirm: (1) Role Visibility section exists, (2) announcement templates for all three agents, (3) summary template after completion</verify>
  <done>orchestrate.md announces all agent spawns with purpose and summarizes results in compact format</done>
</task>

<task type="auto">
  <name>Task 2: Update subagent return message formats</name>
  <files>
    packages/arios-cli/templates/.claude/agents/researcher.md
    packages/arios-cli/templates/.claude/agents/planner.md
    packages/arios-cli/templates/.claude/agents/executor.md
  </files>
  <action>
Update all three agent files to return compact, structured messages:

**researcher.md** - Update output section:
```
Return message (compact - 5-10 lines max):

## RESEARCH COMPLETE

**Topic:** {topic}
**Confidence:** {HIGH/MEDIUM/LOW}
**Findings:** {count} patterns, {count} concerns

Key:
- {finding 1 - one line}
- {finding 2 - one line}
- {finding 3 - one line}

File: `{output path}`
```

**planner.md** - Update output section (or add if missing):
```
Return message (compact - 5-10 lines max):

## PLANNING COMPLETE

**Phase:** {phase name}
**Plans:** {count} plans in {count} waves

Structure:
- Wave 1: {plan IDs} ({parallel|sequential})
- Wave 2: {plan IDs}

File: `{output path}`
```

**executor.md** - Update output section (or add if missing):
```
Return message (compact - 5-10 lines max):

## EXECUTION COMPLETE

**Wave:** {N}
**Status:** {Complete/Partial/Failed}
**Tasks:** {completed}/{total}

Changes:
- {file 1}: {brief description}
- {file 2}: {brief description}

{If failures: "Issues: {count} - see problems/"}
```

Key principles for all agents:
- Return message is for orchestrator to parse, not user to read directly
- Keep to 5-10 lines maximum
- Full details go in output files, not return message
- Use consistent header format: "## {STAGE} COMPLETE"
  </action>
  <verify>Read all three agent files and confirm return message sections are compact (5-10 lines), structured, and use consistent "## X COMPLETE" format</verify>
  <done>All agent files return compact, parseable messages with consistent format</done>
</task>

</tasks>

<verification>
1. Read orchestrate.md and verify Role Visibility section with announcement/summary templates
2. Read researcher.md, planner.md, executor.md and verify compact return message formats
3. Confirm all return messages use "## X COMPLETE" header pattern
4. Confirm orchestrator never instructs to show raw subagent output
</verification>

<success_criteria>
- Orchestrator has Role Visibility section explaining announcement protocol
- Each agent spawn pattern includes display announcement before Task tool call
- Orchestrator summarizes subagent results after completion (not raw output)
- All three agents have compact return messages (5-10 lines max)
- Return messages use consistent "## X COMPLETE" format with structured fields
</success_criteria>

<output>
After completion, create `.planning/phases/07-e2e-flow-role-clarity/07-02-SUMMARY.md`
</output>
