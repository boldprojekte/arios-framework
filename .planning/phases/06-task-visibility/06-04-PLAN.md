---
phase: 06-task-visibility
plan: 04
type: execute
wave: 2
depends_on: ["06-03"]
files_modified:
  - packages/arios-dashboard/src/client/kanban.js
  - packages/arios-dashboard/src/client/list.js
  - packages/arios-dashboard/src/client/roadmap.js
  - packages/arios-dashboard/src/client/app.js
autonomous: true

must_haves:
  truths:
    - "Tasks display in Kanban columns grouped by status"
    - "Tasks display in List view as rows"
    - "View switching updates the display without page reload"
    - "Roadmap tab shows phases with completion status"
    - "Clicking a task shows expanded details in modal"
  artifacts:
    - path: "packages/arios-dashboard/src/client/kanban.js"
      provides: "Kanban board rendering"
      exports: ["renderKanban"]
    - path: "packages/arios-dashboard/src/client/list.js"
      provides: "List view rendering"
      exports: ["renderList"]
    - path: "packages/arios-dashboard/src/client/roadmap.js"
      provides: "Roadmap visualization"
      exports: ["renderRoadmap"]
  key_links:
    - from: "packages/arios-dashboard/src/client/app.js"
      to: "packages/arios-dashboard/src/client/kanban.js"
      via: "import renderKanban"
      pattern: "import.*kanban"
    - from: "packages/arios-dashboard/src/client/app.js"
      to: "packages/arios-dashboard/src/client/list.js"
      via: "import renderList"
      pattern: "import.*list"
---

<objective>
Implement the three view rendering modules: Kanban board, List view, and Roadmap visualization.

Purpose: These are the primary ways users see task and progress data. Kanban shows workflow status at a glance, List shows details in rows, and Roadmap shows high-level phase progress.
Output: Fully rendered task views that update when state changes.
</objective>

<execution_context>
@/Users/j.franke/.claude/get-shit-done/workflows/execute-plan.md
@/Users/j.franke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/06-task-visibility/06-CONTEXT.md
@.planning/phases/06-task-visibility/06-RESEARCH.md
@packages/arios-dashboard/src/types/dashboard.ts
@packages/arios-dashboard/src/client/index.html
@packages/arios-dashboard/src/client/app.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement Kanban board rendering</name>
  <files>packages/arios-dashboard/src/client/kanban.js</files>
  <action>
Create Kanban board renderer:

1. Export renderKanban(tasks: Task[], onTaskClick: (taskId: string) => void)

2. Get column containers by data-status attribute:
   - #pending-tasks
   - #in-progress-tasks
   - #complete-tasks

3. Clear existing content in each column

4. Group tasks by status:
```javascript
const grouped = {
  pending: tasks.filter(t => t.status === 'pending'),
  'in-progress': tasks.filter(t => t.status === 'in-progress'),
  complete: tasks.filter(t => t.status === 'complete')
};
```

5. For each task, create card element:
```javascript
function createTaskCard(task, onClick) {
  const card = document.createElement('div');
  card.className = 'task-card';
  card.dataset.taskId = task.id;

  card.innerHTML = `
    <div class="task-header">
      <span class="task-id">${task.id}</span>
      <span class="task-wave">Wave ${task.wave}</span>
    </div>
    <div class="task-name">${task.name || 'Unnamed task'}</div>
    ${task.dependsOn.length > 0 ?
      `<div class="task-deps">Depends: ${task.dependsOn.join(', ')}</div>` : ''}
    ${task.duration ?
      `<div class="task-duration">${task.duration}</div>` : ''}
  `;

  card.addEventListener('click', () => onClick(task.id));
  return card;
}
```

6. Append cards to appropriate columns

7. Add CSS class for update animation on re-render:
   - Track previous task IDs
   - Add 'updated' class to changed cards
   - setTimeout to remove class after animation
  </action>
  <verify>`cat packages/arios-dashboard/src/client/kanban.js | grep "export function renderKanban"` shows export</verify>
  <done>Kanban board renders tasks in status columns with click handling</done>
</task>

<task type="auto">
  <name>Task 2: Implement List view rendering</name>
  <files>packages/arios-dashboard/src/client/list.js</files>
  <action>
Create List view renderer:

1. Export renderList(tasks: Task[], onTaskClick: (taskId: string) => void)

2. Get container: #list-content

3. Clear existing content

4. Create table structure:
```javascript
function renderList(tasks, onTaskClick) {
  const container = document.getElementById('list-content');
  container.innerHTML = '';

  // Sort tasks by phase, then plan number
  const sorted = [...tasks].sort((a, b) => {
    const phaseA = parseInt(a.id.split('-')[0]);
    const phaseB = parseInt(b.id.split('-')[0]);
    if (phaseA !== phaseB) return phaseA - phaseB;
    return a.plan - b.plan;
  });

  // Create table
  const table = document.createElement('table');
  table.className = 'task-list-table';

  // Header
  table.innerHTML = `
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Status</th>
        <th>Wave</th>
        <th>Dependencies</th>
        <th>Duration</th>
      </tr>
    </thead>
    <tbody id="list-tbody"></tbody>
  `;

  const tbody = table.querySelector('#list-tbody');

  // Rows
  for (const task of sorted) {
    const row = createTaskRow(task, onTaskClick);
    tbody.appendChild(row);
  }

  container.appendChild(table);
}
```

5. Create row element:
```javascript
function createTaskRow(task, onClick) {
  const row = document.createElement('tr');
  row.className = `task-row status-${task.status}`;
  row.dataset.taskId = task.id;

  row.innerHTML = `
    <td class="task-id">${task.id}</td>
    <td class="task-name">${task.name || 'Unnamed'}</td>
    <td class="task-status"><span class="status-badge ${task.status}">${task.status}</span></td>
    <td class="task-wave">${task.wave}</td>
    <td class="task-deps">${task.dependsOn.join(', ') || '-'}</td>
    <td class="task-duration">${task.duration || '-'}</td>
  `;

  row.addEventListener('click', () => onClick(task.id));
  return row;
}
```

6. Add row hover effects via CSS (already in styles.css)
  </action>
  <verify>`cat packages/arios-dashboard/src/client/list.js | grep "export function renderList"` shows export</verify>
  <done>List view renders tasks as table rows with sorting and click handling</done>
</task>

<task type="auto">
  <name>Task 3: Implement Roadmap visualization and wire views into app.js</name>
  <files>
    packages/arios-dashboard/src/client/roadmap.js
    packages/arios-dashboard/src/client/app.js
  </files>
  <action>
1. Create roadmap.js:

Export renderRoadmap(phases: Phase[], roadmapMd: string)

```javascript
import { marked } from 'https://cdn.jsdelivr.net/npm/marked@16/+esm';

export function renderRoadmap(phases, roadmapMd) {
  const container = document.getElementById('roadmap-content');
  container.innerHTML = '';

  // Phase summary cards
  const summary = document.createElement('div');
  summary.className = 'roadmap-summary';

  for (const phase of phases) {
    const card = document.createElement('div');
    card.className = `phase-card status-${phase.status}`;

    const progress = phase.plansTotal > 0
      ? Math.round((phase.plansComplete / phase.plansTotal) * 100)
      : 0;

    card.innerHTML = `
      <div class="phase-header">
        <span class="phase-number">Phase ${phase.id}</span>
        <span class="phase-status">${phase.status}</span>
      </div>
      <div class="phase-name">${phase.name}</div>
      <div class="phase-progress">
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${progress}%"></div>
        </div>
        <span class="progress-text">${phase.plansComplete}/${phase.plansTotal}</span>
      </div>
    `;

    summary.appendChild(card);
  }

  container.appendChild(summary);

  // Full roadmap markdown
  if (roadmapMd) {
    const details = document.createElement('div');
    details.className = 'roadmap-details';
    details.innerHTML = marked.parse(roadmapMd);
    container.appendChild(details);
  }
}
```

2. Update app.js to wire all views:

Add imports at top:
```javascript
import { renderKanban } from './kanban.js';
import { renderList } from './list.js';
import { renderRoadmap } from './roadmap.js';
```

Update render() function:
```javascript
function render() {
  updatePhaseIndicator();

  // Render tasks view based on current view mode
  if (state.currentView === 'kanban') {
    renderKanban(state.tasks, showTaskDetail);
    document.getElementById('kanban-board').classList.remove('hidden');
    document.getElementById('list-view').classList.add('hidden');
  } else {
    renderList(state.tasks, showTaskDetail);
    document.getElementById('list-view').classList.remove('hidden');
    document.getElementById('kanban-board').classList.add('hidden');
  }

  // Render roadmap
  renderRoadmap(state.phases, state.roadmap);
}
```

Add showTaskDetail function:
```javascript
function showTaskDetail(taskId) {
  const task = state.tasks.find(t => t.id === taskId);
  if (!task) return;

  const modal = document.getElementById('task-modal');
  const body = document.getElementById('modal-body');

  body.innerHTML = `
    <h2>${task.id}: ${task.name || 'Unnamed Task'}</h2>
    <div class="detail-grid">
      <div class="detail-item"><strong>Phase:</strong> ${task.phase}</div>
      <div class="detail-item"><strong>Status:</strong> ${task.status}</div>
      <div class="detail-item"><strong>Wave:</strong> ${task.wave}</div>
      <div class="detail-item"><strong>Dependencies:</strong> ${task.dependsOn.join(', ') || 'None'}</div>
      ${task.duration ? `<div class="detail-item"><strong>Duration:</strong> ${task.duration}</div>` : ''}
      ${task.completedAt ? `<div class="detail-item"><strong>Completed:</strong> ${task.completedAt}</div>` : ''}
    </div>
    ${task.filesModified ? `
      <div class="detail-files">
        <strong>Files:</strong>
        <ul>${task.filesModified.map(f => `<li>${f}</li>`).join('')}</ul>
      </div>
    ` : ''}
    ${task.summary ? `<div class="detail-summary">${task.summary}</div>` : ''}
  `;

  modal.classList.add('active');
}
```
  </action>
  <verify>
    `cat packages/arios-dashboard/src/client/app.js | grep "import.*kanban"` shows import
    `cat packages/arios-dashboard/src/client/roadmap.js | grep "export function renderRoadmap"` shows export
  </verify>
  <done>All views wired into app.js with task detail modal</done>
</task>

</tasks>

<verification>
1. Start dashboard server
2. Verify Kanban shows tasks in correct columns
3. Toggle to List view, verify table renders
4. Switch to Roadmap tab, verify phases display with progress bars
5. Click a task, verify modal opens with details
6. Modify a .planning file, verify views update (highlight animation)
</verification>

<success_criteria>
- Kanban board displays tasks grouped by status
- List view shows all tasks in sorted table
- Roadmap shows phase cards with progress bars
- View toggle switches between Kanban and List
- Clicking task opens detail modal
- Updates trigger re-render with highlight animation
</success_criteria>

<output>
After completion, create `.planning/phases/06-task-visibility/06-04-SUMMARY.md`
</output>
