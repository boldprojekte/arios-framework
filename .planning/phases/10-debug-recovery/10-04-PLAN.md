---
phase: 10-debug-recovery
plan: 04
type: execute
wave: 2
depends_on: ["10-01"]
files_modified:
  - packages/arios-cli/templates/.claude/commands/arios/orchestrate.md
autonomous: true

must_haves:
  truths:
    - "Error messages describe impact in plain language"
    - "Technical details hidden by default"
    - "Errors logged to debug.log with timestamp"
  artifacts:
    - path: "packages/arios-cli/templates/.claude/commands/arios/orchestrate.md"
      provides: "Error translation table and debug.log appending"
      contains: "Plain-Language Error"
  key_links:
    - from: "orchestrate.md"
      to: "debug.log"
      via: "append on escalation"
      pattern: "append.*debug\\.log|write.*debug\\.log"
---

<objective>
Add plain-language error presentation and debug.log persistence

Purpose: Error messages describe impact in plain language, not technical jargon (DEBUG-04). Technical details hidden by default. Escalated errors logged to debug.log for history.

Output: Error translation patterns and debug logging in orchestrate.md
</objective>

<execution_context>
@/Users/j.franke/.claude/get-shit-done/workflows/execute-plan.md
@/Users/j.franke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-debug-recovery/10-CONTEXT.md
@.planning/phases/10-debug-recovery/10-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add plain-language error section to orchestrate.md</name>
  <files>packages/arios-cli/templates/.claude/commands/arios/orchestrate.md</files>
  <action>
Add a new section "## Plain-Language Error Presentation" after the "## Handling Escalation" section (or after "## Report" if Escalation section doesn't exist yet).

**Section content:**
```markdown
## Plain-Language Error Presentation

When presenting errors to users, translate technical messages into impact-focused language.

### Error Translation Table

| Technical Error | Plain Language |
|-----------------|----------------|
| `TypeError: Cannot read property 'X' of undefined` | "The code tried to use something that doesn't exist yet" |
| `ECONNREFUSED 127.0.0.1:5432` | "The database isn't running or can't be reached" |
| `Module not found: 'X'` | "A required package is missing from the project" |
| `ENOENT: no such file or directory` | "A file the code needs doesn't exist" |
| `SyntaxError` | "There's a typo in the code" |
| `401 Unauthorized` | "The app doesn't have permission to access this service" |
| `403 Forbidden` | "Access to this resource is blocked" |
| `429 Too Many Requests` | "The service is rate-limiting requests (too many too fast)" |
| `ETIMEDOUT` | "The request took too long and timed out" |
| `npm ERR! peer dep` | "Some packages have version conflicts" |
| `TypeScript error TS2322` | "A value doesn't match the expected type" |

### Translation Pattern

When displaying errors to user:

1. **Lead with impact:**
   ```
   "The app can't start because [plain language reason]"
   "Tests are failing because [plain language reason]"
   ```

2. **Add what it affects:**
   ```
   "This blocks: [downstream feature/phase]"
   "This doesn't block anything else"
   ```

3. **Then offer options:**
   ```
   "Options: Retry (r), Skip (s), Abort (a)"
   ```

4. **Technical details available but hidden:**
   ```
   (Technical details in debug.log if needed)
   ```

### Example Transformation

**Technical (what recovery-agent sees):**
```
TypeError: Cannot read properties of undefined (reading 'map')
    at TaskList.tsx:42
    at renderWithHooks (react-dom.development.js:14985)
    ...
```

**Plain language (what user sees):**
```
The task list can't display because it's trying to loop through data that hasn't loaded yet.

This blocks: Dashboard view

Options: Retry (r), Skip (s), Abort (a)
(Full error in .planning/debug.log)
```

### Claude's Discretion

- Adapt tone to context (neutral vs reassuring based on severity)
- Phrase "what it affects" based on specific failure
- Add context-specific details when helpful
```
  </action>
  <verify>
Run: `grep -n "Plain-Language Error" packages/arios-cli/templates/.claude/commands/arios/orchestrate.md`
Expect: Section heading found
Run: `grep -n "Error Translation Table" packages/arios-cli/templates/.claude/commands/arios/orchestrate.md`
Expect: Table heading found
  </verify>
  <done>orchestrate.md has error translation table and plain-language presentation pattern</done>
</task>

<task type="auto">
  <name>Task 2: Add debug.log appending logic to orchestrate.md</name>
  <files>packages/arios-cli/templates/.claude/commands/arios/orchestrate.md</files>
  <action>
Add a new section "## Debug Log Persistence" after the "## Plain-Language Error Presentation" section.

**Section content:**
```markdown
## Debug Log Persistence

**Purpose:** Record errors that reach escalation for later debugging. Auto-corrected issues are NOT logged (they were handled successfully).

**When to log:**
- Recovery exhausted (3/3 attempts failed)
- RECOVERY ESCALATE returned (immediate user escalation)
- User reports issue during phase review that can't be auto-fixed

**Log format:**
```
[ISO-TIMESTAMP] [{TYPE}] [{PHASE-PLAN}] {Plain-language summary}
Technical: {original error - one line}
Resolution: {what user chose - retry/skip/abort}
---
```

**Appending to debug.log:**

After escalating to user and receiving their choice:
```
Use Bash tool:
command: "echo '[{timestamp}] [{type}] [{plan_id}] {summary}
Technical: {error_oneline}
Resolution: {user_choice}
---' >> .planning/debug.log"
```

**Example log entry:**
```
[2026-01-25T15:30:00Z] [task_failure] [10-02] Database connection failed after 3 attempts
Technical: ECONNREFUSED 127.0.0.1:5432
Resolution: abort
---
```

**What NOT to log:**
- Successful auto-fixes (handled silently)
- Recovery that succeeded on attempt 2 or 3 (eventually fixed)
- Warnings that didn't block execution
```
  </action>
  <verify>
Run: `grep -n "Debug Log Persistence" packages/arios-cli/templates/.claude/commands/arios/orchestrate.md`
Expect: Section heading found
Run: `grep -n ">> .planning/debug.log" packages/arios-cli/templates/.claude/commands/arios/orchestrate.md`
Expect: Append command found
  </verify>
  <done>orchestrate.md has debug.log appending logic for escalated errors</done>
</task>

</tasks>

<verification>
1. orchestrate.md has Error Translation Table
2. orchestrate.md has plain-language presentation pattern (impact first)
3. orchestrate.md has Debug Log Persistence section
4. debug.log appending only happens for escalated errors
5. Technical details referenced but not shown inline
</verification>

<success_criteria>
- Error messages are impact-focused, not technical jargon
- Technical details available in debug.log if needed
- Only escalated errors logged (not auto-fixed issues)
- User sees "what's broken" + "what it affects" + "options"
</success_criteria>

<output>
After completion, create `.planning/phases/10-debug-recovery/10-04-SUMMARY.md`
</output>
