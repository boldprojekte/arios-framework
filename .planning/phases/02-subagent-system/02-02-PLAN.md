---
phase: 02-subagent-system
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/arios-cli/templates/.claude/agents/researcher.md
  - packages/arios-cli/templates/.claude/agents/planner.md
  - packages/arios-cli/templates/.claude/agents/executor.md
autonomous: true

must_haves:
  truths:
    - "Researcher agent receives topic and writes structured findings"
    - "Planner agent reads findings and creates plans with Claude Tasks"
    - "Executor agent executes at wave level and reports problems"
    - "All agents use consistent YAML frontmatter handoff format"
  artifacts:
    - path: "packages/arios-cli/templates/.claude/agents/researcher.md"
      provides: "Researcher subagent prompt"
      contains: "name: researcher"
    - path: "packages/arios-cli/templates/.claude/agents/planner.md"
      provides: "Planner subagent prompt"
      contains: "name: planner"
    - path: "packages/arios-cli/templates/.claude/agents/executor.md"
      provides: "Executor subagent prompt"
      contains: "name: executor"
  key_links:
    - from: "researcher.md"
      to: ".arios/roadmaps/{roadmap}/phases/{phase}/researcher/"
      via: "output path"
      pattern: "findings-\\d+\\.md"
    - from: "planner.md"
      to: "Claude Tasks"
      via: "TaskCreate tool"
      pattern: "writes Claude Tasks directly"
---

<objective>
Create subagent prompt files for Researcher, Planner, and Executor.

Purpose: Defines the specialized agents that the orchestrator spawns. Each agent has a focused role, receives context from orchestrator, and writes structured output to files.

Output: Three agent prompt files in `.claude/agents/` template directory, ready to be installed to target projects.
</objective>

<execution_context>
@/Users/j.franke/.claude/get-shit-done/workflows/execute-plan.md
@/Users/j.franke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-subagent-system/02-CONTEXT.md
@.planning/phases/02-subagent-system/02-RESEARCH.md

# Reference agent patterns from GSD
@/Users/j.franke/.claude/agents/gsd-executor.md

# Existing ARIOS template structure
@packages/arios-cli/templates/.claude/commands/arios/start.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create researcher agent prompt</name>
  <files>packages/arios-cli/templates/.claude/agents/researcher.md</files>
  <action>
Create `.claude/agents/` directory in templates if not exists.

Create `researcher.md` with YAML frontmatter and focused prompt:

**Frontmatter:**
```yaml
---
name: researcher
description: Investigates implementation approaches when domain is unclear. Spawned by ARIOS orchestrator for research tasks.
tools: Read, Grep, Glob, Bash, WebSearch, WebFetch
model: inherit
---
```

**Prompt structure (lean, not verbose):**

1. `<role>` - ARIOS researcher, investigates approaches, writes findings for planner
   - Spawned when domain unclear or requires current documentation
   - Job: Answer research question, write findings file

2. `<input>` - What orchestrator provides:
   - Research question/topic
   - Phase context
   - Specific areas to investigate
   - Output file path

3. `<workflow>` - Numbered steps:
   1. Read .arios/STATE.md for project context
   2. Read phase CONTEXT.md if exists (locked decisions)
   3. Investigate using available tools
   4. Write findings to specified path
   5. Return structured completion message

4. `<output>` - Handoff format:
   - Path: Provided by orchestrator
   - Format: Markdown with YAML frontmatter (version, type: findings, status, created, phase, agent, confidence)
   - Return message template with topic, confidence, key findings, file path, "Ready for Planning"

Keep entire file under 80 lines. Leave room for LLM thinking - Opus is smart.
  </action>
  <verify>
    - `cat packages/arios-cli/templates/.claude/agents/researcher.md` shows complete prompt
    - YAML frontmatter has required fields (name, description, tools)
    - `wc -l packages/arios-cli/templates/.claude/agents/researcher.md` is under 80 lines
  </verify>
  <done>Researcher agent prompt created with role, input, workflow, output sections</done>
</task>

<task type="auto">
  <name>Task 2: Create planner agent prompt</name>
  <files>packages/arios-cli/templates/.claude/agents/planner.md</files>
  <action>
Create `planner.md` with YAML frontmatter and focused prompt:

**Frontmatter:**
```yaml
---
name: planner
description: Creates implementation plans and Claude Tasks from research findings. Spawned by ARIOS orchestrator for planning.
tools: Read, Write, Grep, Glob, Bash, TaskCreate, TaskList
model: inherit
---
```

**Prompt structure:**

1. `<role>` - ARIOS planner, creates plans from findings, writes Claude Tasks
   - Key decision from CONTEXT.md: Planner writes Tasks directly (no translation step)
   - Job: Read findings, create plan file, create Claude Tasks

2. `<input>` - What orchestrator provides:
   - Findings file path (from researcher)
   - Phase context
   - Output plan path

3. `<workflow>` - Numbered steps:
   1. Read .arios/STATE.md for project context
   2. Read findings file if exists
   3. Read phase CONTEXT.md (user's vision - honor it)
   4. Create plan with wave structure
   5. Create Claude Tasks for each task in plan
   6. Write plan file to specified path
   7. Return structured completion message

4. `<plan_format>` - What plan file contains:
   - YAML frontmatter (version, type: plan, status, created, phase, agent, tasks_created, task_ids)
   - Waves section: group tasks by dependency
   - Each task: files, action, verify, done
   - Wave-level execution (not individual task level)

5. `<output>` - Return message template with plan path, task count, wave count, task IDs

Keep under 100 lines. Task creation is the key differentiator from researcher.
  </action>
  <verify>
    - `cat packages/arios-cli/templates/.claude/agents/planner.md` shows complete prompt
    - YAML frontmatter includes TaskCreate and TaskList tools
    - `wc -l packages/arios-cli/templates/.claude/agents/planner.md` is under 100 lines
  </verify>
  <done>Planner agent prompt created with task writing capability</done>
</task>

<task type="auto">
  <name>Task 3: Create executor agent prompt</name>
  <files>packages/arios-cli/templates/.claude/agents/executor.md</files>
  <action>
Create `executor.md` with YAML frontmatter and focused prompt:

**Frontmatter:**
```yaml
---
name: executor
description: Executes plan waves, updates task status, and reports problems. Spawned by ARIOS orchestrator for implementation.
tools: Read, Write, Edit, Bash, Grep, Glob, TaskUpdate, TaskGet
model: inherit
---
```

**Prompt structure:**

1. `<role>` - ARIOS executor, implements at wave level, updates tasks
   - Key decision: Wave-level execution (not individual tasks - that's overkill)
   - Works with Claude Task system (updates status, marks complete)
   - Can create new tasks if problems require (trusted to set dependencies)
   - Job: Execute wave, update tasks, report problems

2. `<input>` - What orchestrator provides:
   - Plan file path
   - Wave number to execute
   - Task IDs for this wave
   - Problems directory path

3. `<workflow>` - Numbered steps:
   1. Read plan file for wave tasks
   2. For each task in wave:
      a. Update task status to in_progress
      b. Execute task (follow action, create files)
      c. Run verify step
      d. If verify fails: write problem file, update task to blocked
      e. If verify passes: update task to done
   3. Return wave completion status

4. `<problem_reporting>` - When issues occur:
   - Write detailed problem to `problems/problem-{timestamp}.md`
   - Include: what failed, why, suggested fix, related task
   - Link in task comment for orchestrator visibility

5. `<output>` - Return message with wave number, tasks completed/failed/blocked

Keep under 100 lines. Focus on wave execution pattern.
  </action>
  <verify>
    - `cat packages/arios-cli/templates/.claude/agents/executor.md` shows complete prompt
    - YAML frontmatter includes TaskUpdate and TaskGet tools
    - `wc -l packages/arios-cli/templates/.claude/agents/executor.md` is under 100 lines
  </verify>
  <done>Executor agent prompt created with wave execution and problem reporting</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `ls packages/arios-cli/templates/.claude/agents/` shows researcher.md, planner.md, executor.md
2. Each file has valid YAML frontmatter with name, description, tools
3. All files under line limit (80-100 lines)
4. Consistent structure across all agents (role, input, workflow, output)
</verification>

<success_criteria>
- Three agent prompt files exist in templates directory
- Each agent has focused role matching CONTEXT.md decisions
- Planner has TaskCreate/TaskList tools
- Executor has TaskUpdate/TaskGet tools
- Handoff format consistent (YAML frontmatter with type, status, etc.)
- Prompts are lean (under 100 lines each)
</success_criteria>

<output>
After completion, create `.planning/phases/02-subagent-system/02-02-SUMMARY.md`
</output>
