---
phase: 11-smart-entry-mode-detection
plan: 02
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - packages/arios-cli/templates/.claude/commands/arios/feature.md
  - packages/arios-cli/templates/.claude/commands/arios/project.md
autonomous: true

must_haves:
  truths:
    - "User can run /arios:feature to explicitly enter Feature-Mode"
    - "User can run /arios:project to explicitly enter Project-Mode"
    - "Explicit commands check for active work before proceeding"
    - "Explicit commands skip mode detection conversation"
  artifacts:
    - path: "packages/arios-cli/templates/.claude/commands/arios/feature.md"
      provides: "Explicit Feature-Mode entry command"
      contains: "Feature-Mode"
    - path: "packages/arios-cli/templates/.claude/commands/arios/project.md"
      provides: "Explicit Project-Mode entry command"
      contains: "Project-Mode"
  key_links:
    - from: "feature.md"
      to: "/ideate"
      via: "routes to ideation"
      pattern: "ideate"
    - from: "project.md"
      to: "/ideate"
      via: "routes to ideation"
      pattern: "ideate"
---

<objective>
Create explicit mode entry commands: /arios:feature and /arios:project

Purpose: Allow users who know what mode they want to skip the detection conversation. Per CONTEXT.md: "Explicit mode commands skip detection conversation but still check for active work/state."

Output: Two new command files that enter specific modes directly while respecting active state.
</objective>

<execution_context>
@/Users/j.franke/.claude/get-shit-done/workflows/execute-plan.md
@/Users/j.franke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/11-smart-entry-mode-detection/11-CONTEXT.md
@.planning/phases/11-smart-entry-mode-detection/11-RESEARCH.md
@packages/arios-cli/templates/.claude/commands/arios/arios.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create /arios:feature explicit command</name>
  <files>packages/arios-cli/templates/.claude/commands/arios/feature.md</files>
  <action>
Create a new command file following the established Input-Workflow-Output template pattern.

```markdown
---
description: Enter Feature-Mode directly, skipping mode detection conversation
---

# /arios:feature

## Purpose

Enter Feature-Mode directly for focused, single-phase work. Skips the mode detection conversation but still checks for active work.

## Context

- @.planning/STATE.md
- @.planning/config.json

## Instructions

### 1. Check for Active Work

Read STATE.md and config.json if they exist.

**If active work exists (status is NOT "complete" or "phase-complete"):**

Display:
```
## Active Work in Progress

You have active {mode} work: {phaseName}

Complete current work first, or run `/arios:reset` to start fresh.

**Current status:** {status}
**Progress:** {planIndex}/{totalPlans}
```

Stop here - do not proceed.

**If project has ROADMAP.md (existing project work):**

Display:
```
## Existing Project Detected

This project has an active roadmap. Starting a new feature would conflict with project work.

Options:
1. Continue with project: `/arios` to resume
2. Start fresh: `/arios:reset` to clear state and start new feature

What would you like to do? (1/2):
```

Handle user choice accordingly.

### 2. Enter Feature-Mode

If no active work or user confirmed reset:

1. Clear any stale state (if exists)
2. Write to .planning/config.json: `{ "mode": "feature", ... }`
3. Display:
   ```
   ## Feature-Mode

   Ready for focused, single-phase work.

   What feature would you like to build?
   ```
4. Wait for user response
5. Mirror understanding: "Got it - you want to [feature]. Let me plan that."
6. Route to `/ideate` with feature context

### 3. Feature Context for Ideation

When routing to /ideate, pass context indicating Feature-Mode:
- Single-phase workflow (no multi-phase roadmap)
- Phase folder will be `.planning/phases/feature-{name}/`
- On completion: archive to `.planning/archive/`

## Workflow

1. Check for active work in STATE.md
2. If active: display warning, stop
3. If has ROADMAP.md: ask about conflict, handle choice
4. Clear stale state
5. Write mode to config.json
6. Display Feature-Mode entry message
7. Wait for user's feature description
8. Route to /ideate with feature context

## Report

### Feature-Mode Entry
```
## Feature-Mode

Ready for focused, single-phase work.

What feature would you like to build?
```

### Blocked by Active Work
```
## Active Work in Progress

You have active {mode} work: {phaseName}

Complete current work first, or run `/arios:reset` to start fresh.
```
```
  </action>
  <verify>Read feature.md and confirm it contains: active work check, mode storage in config.json, Feature-Mode entry message, route to /ideate</verify>
  <done>feature.md exists with active work check, mode storage, and routing to ideation</done>
</task>

<task type="auto">
  <name>Task 2: Create /arios:project explicit command</name>
  <files>packages/arios-cli/templates/.claude/commands/arios/project.md</files>
  <action>
Create a new command file following the established Input-Workflow-Output template pattern.

```markdown
---
description: Enter Project-Mode directly, skipping mode detection conversation
---

# /arios:project

## Purpose

Enter Project-Mode directly for multi-phase project work. Skips the mode detection conversation but still checks for active work.

## Context

- @.planning/STATE.md
- @.planning/config.json
- @.planning/ROADMAP.md

## Instructions

### 1. Check for Active Work

Read STATE.md and config.json if they exist.

**If active Feature-Mode work exists:**

Display:
```
## Active Feature in Progress

You have an active feature: {phaseName}

Complete the feature first, or run `/arios:reset` to start fresh project.

**Current status:** {status}
**Progress:** {planIndex}/{totalPlans}
```

Stop here - do not proceed.

**If active Project-Mode work exists (has ROADMAP.md):**

Display:
```
## Existing Project Detected

You already have a project in progress.

Phase: {phase}/{totalPhases} - {phaseName}
Status: {status}

Run `/arios` to continue with your project.
```

Stop here - user should use /arios to resume.

### 2. Enter Project-Mode

If no active work:

1. Write to .planning/config.json: `{ "mode": "project", ... }`
2. Display:
   ```
   ## Project-Mode

   Ready for multi-phase project work with full roadmap.

   What project would you like to build?
   ```
3. Wait for user response
4. Mirror understanding: "Got it - you want to build [project]. Let me help you plan this."
5. Route to `/ideate` with project context

### 3. Project Context for Ideation

When routing to /ideate, pass context indicating Project-Mode:
- Multi-phase roadmap workflow
- Will create ROADMAP.md
- Phase folders will be numbered `.planning/phases/01-xxx/`, `.planning/phases/02-xxx/`

## Workflow

1. Check for active work in STATE.md
2. If active feature: display warning, stop
3. If active project: display resume message, stop
4. Write mode to config.json
5. Display Project-Mode entry message
6. Wait for user's project description
7. Route to /ideate with project context

## Report

### Project-Mode Entry
```
## Project-Mode

Ready for multi-phase project work with full roadmap.

What project would you like to build?
```

### Blocked by Active Feature
```
## Active Feature in Progress

You have an active feature: {phaseName}

Complete the feature first, or run `/arios:reset` to start fresh project.
```

### Existing Project
```
## Existing Project Detected

You already have a project in progress.

Run `/arios` to continue with your project.
```
```
  </action>
  <verify>Read project.md and confirm it contains: active work check (both modes), mode storage in config.json, Project-Mode entry message, route to /ideate</verify>
  <done>project.md exists with active work checks for both modes, mode storage, and routing to ideation</done>
</task>

</tasks>

<verification>
- [ ] feature.md exists at packages/arios-cli/templates/.claude/commands/arios/feature.md
- [ ] project.md exists at packages/arios-cli/templates/.claude/commands/arios/project.md
- [ ] Both commands check for active work before proceeding
- [ ] Both commands write mode to config.json
- [ ] Both commands route to /ideate with appropriate context
- [ ] feature.md handles conflict with existing ROADMAP.md
- [ ] project.md handles both active feature and active project cases
</verification>

<success_criteria>
- /arios:feature enters Feature-Mode directly when no active work
- /arios:project enters Project-Mode directly when no active work
- Both commands block if conflicting active work exists
- Both commands store mode in config.json
- Both commands route to ideation after user describes what they want
</success_criteria>

<output>
After completion, create `.planning/phases/11-smart-entry-mode-detection/11-02-SUMMARY.md`
</output>
